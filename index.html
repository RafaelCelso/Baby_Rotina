<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Registro de Mamadas</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">
    <link rel="stylesheet" href="styles.css">
    <link rel="manifest" href="manifest.json">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <style>
        body {
            padding-top: 5px; /* Ajustado de 70px para 65px */
            color: white; /* Alterando a cor do texto para branco */
        }
        @media (min-width: 992px) {
            .navbar-nav {
                position: absolute;
                left: 50%;
                transform: translateX(-50%);
            }
        }
        .custom-navbar {
            background-color: transparent; /* Removendo a cor de fundo */
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            padding-top: 5px; /* Reduzido de 10px para 5px */
            padding-bottom: 5px; /* Reduzido de 10px para 5px */
            margin-bottom: 5px; /* Reduzido de 10px para 5px */
        }
        .custom-navbar .navbar-brand,
        .custom-navbar .nav-link {
            color: white !important;
        }
        .custom-navbar .nav-link:hover {
            color: rgba(255, 255, 255, 0.8) !important;
        }
        .custom-navbar .navbar-toggler-icon {
            background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 30 30'%3e%3cpath stroke='rgba(255, 255, 255, 0.8)' stroke-linecap='round' stroke-miterlimit='10' stroke-width='2' d='M4 7h22M4 15h22M4 23h22'/%3e%3c/svg%3e");
        }
        
        .navbar-brand img {
            width: 200px;
            height: auto;
        }

        @media (max-width: 767px) {
            .navbar-brand img {
                width: 160px; /* Um pouco menor em telas muito pequenas */
            }
        }

        @media (min-width: 768px) and (max-width: 991px) {
            .navbar-brand img {
                width: 180px; /* Tamanho intermediário para telas médias */
            }
        }

        /* Estilo para o fundo em dispositivos móveis */
        @media (max-width: 767px) {
            body {
                background-image: url('img/bg-mamadas-mobile.png');
                background-repeat: no-repeat;
                background-position: center center;
                background-attachment: fixed;
                background-size: cover;
            }
        }

        /* Novo estilo para o fundo em telas grandes */
        @media (min-width: 768px) {
            body {
                background-image: url('img/bg-mamadas.png');
                background-repeat: no-repeat;
                background-position: center center;
                background-attachment: fixed;
                background-size: cover;
            }
        }

        /* Novo estilo para melhorar a legibilidade do conteúdo */
        .container {
            background-color: rgba(0, 0, 0, 0.5); /* Fundo semi-transparente */
            padding: 20px;
            border-radius: 10px;
            margin-top: 20px;
            margin-bottom: 10px; /* Aumentando a margem inferior */
        }

        /* Ajustando a cor dos inputs e labels */
        .form-label, .form-control {
            color: white;
        }

        .form-control {
            background-color: rgba(255, 255, 255, 0.1);
            border-color: rgba(255, 255, 255, 0.2);
        }

        .form-control:focus {
            background-color: rgba(255, 255, 255, 0.2);
            color: white;
        }

        /* Ajustando a cor do texto nos modais */
        .modal-content {
            background-color: rgba(255, 255, 255, 0.8);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.18);
            box-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.37);
            color: black;
        }

        /* Ajuste para o cabeçalho e rodapé dos modais */
        .modal-header, .modal-footer {
            border-color: rgba(0, 0, 0, 0.1);
        }

        /* Ajuste para os inputs dentro dos modais */
        .modal-content .form-control {
            background-color: rgba(255, 255, 255, 0.5);
            border-color: rgba(0, 0, 0, 0.1);
            color: black;
        }

        .modal-content .form-control:focus {
            background-color: rgba(255, 255, 255, 0.7);
            color: black;
        }

        /* Ajuste para os labels dentro dos modais */
        .modal-content .form-label {
            color: black;
        }

        /* Ajuste para os botões dentro dos modais */
        .modal-content .btn {
            backdrop-filter: blur(5px);
            -webkit-backdrop-filter: blur(5px);
        }

        /* Ajuste para telas menores */
        @media (max-width: 767px) {
            .container {
                width: 90%; /* Reduz a largura para 90% em telas menores */
                max-width: none; /* Remove o max-width padrão do Bootstrap */
                margin-bottom: 10px; /* Ajustando a margem inferior para telas menores */
            }
            .custom-navbar {
                margin-bottom: 2px; /* Reduzido de 5px para 2px em telas menores */
            }
        }

        /* Estilo para o seletor de bebê */
        #selectedBabyName {
            font-size: 1.5rem; /* Reduzindo o tamanho da fonte */
            padding: 0.5rem 1rem; /* Reduzindo o padding */
        }

        /* Ajuste para telas menores */
        @media (max-width: 767px) {
            #selectedBabyName {
                font-size: 1.2rem; /* Fonte ainda menor em telas pequenas */
                padding: 0.3rem 0.8rem; /* Padding menor em telas pequenas */
            }
        }

        /* Estilo para os botões de cadastro e lista de bebês */
        .btn-lg {
            padding: 0.75rem 1.5rem;
            font-size: 1.1rem;
            border-radius: 10px;
            transition: all 0.3s ease;
        }

        .btn-lg:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.2) !important;
        }

        .btn-primary {
            background-color: #007bff;
            border-color: #007bff;
        }

        .btn-success {
            background-color: #28a745;
            border-color: #28a745;
        }

        /* Ajuste para telas menores */
        @media (max-width: 767px) {
            .btn-lg {
                padding: 0.5rem 1rem;
                font-size: 1rem;
            }
        }

        /* Estilo para o botão Registrar Mamada */
        .register-feeding-btn {
            background-color: #ff6b6b;
            border-color: #ff6b6b;
            color: white;
            font-size: 1.2rem;
            padding: 0.75rem 1.5rem;
            border-radius: 50px;
            transition: all 0.3s ease;
        }

        .register-feeding-btn:hover, .register-feeding-btn:focus {
            background-color: #ff5252;
            border-color: #ff5252;
            transform: translateY(-3px);
            box-shadow: 0 10px 20px rgba(255, 107, 107, 0.4) !important;
        }

        .register-feeding-btn:active {
            transform: translateY(-1px);
            box-shadow: 0 5px 10px rgba(255, 107, 107, 0.4) !important;
        }

        /* Ajuste para telas menores */
        @media (max-width: 767px) {
            .register-feeding-btn {
                font-size: 1rem;
                padding: 0.5rem 1rem;
            }
        }

        /* Estilo para o cronômetro */
        #timerContainer {
            background-color: rgba(0, 0, 0, 0.7);
            border-radius: 15px;
            padding: 20px;
            margin-top: 30px;
            margin-bottom: 30px;
        }

        #timer {
            font-size: 4rem;
            font-weight: bold;
            color: #fff;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);
        }

        .btn-group .btn {
            font-size: 1.5rem;
            padding: 10px 20px;
        }
    </style>
    <script type="module" src="firebase-config.js"></script>
</head>

<body>
    <!-- Novo menu responsivo -->
    <nav class="navbar navbar-expand-lg navbar-dark fixed-top custom-navbar">
        <div class="container">
            <a class="navbar-brand" href="inicio.html"><img src="img/logo-baby-rotina.png" alt="Logo"></a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav mx-auto">
                    <li class="nav-item">
                        <a class="nav-link active" id="mamadasLink" aria-current="page" href="index.html">
                            <i class="fas fa-baby-carriage"></i> Mamadas
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#">
                            <i class="fas fa-baby"></i> Troca de Fralda
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#">
                            <i class="fas fa-moon"></i> Soneca
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="perfil.html">
                            <i class="fas fa-user"></i> Perfil
                        </a>
                    </li>
                    <li class="nav-item d-lg-none">
                        <a id="logoutLinkMobile" href="#" class="nav-link text-danger d-lg-none">
                            <i class="fas fa-sign-out-alt"></i> Sair
                        </a>
                    </li>
                </ul>
            </div>
            <a id="logoutLink" href="#" class="btn btn-danger d-none d-lg-inline-block">
                <i class="fas fa-sign-out-alt"></i> Sair
            </a>
        </div>
    </nav>

    <div class="container mt-4">
        <div id="userGreeting" class="mb-4"></div>
        <h1 class="mb-4">Registro de Mamadas</h1>

        <!-- Botões para cadastrar novo bebê e listar bebês cadastrados -->
        <div class="mb-4 mt-5 d-flex justify-content-center gap-3">
            <button class="btn btn-primary btn-lg shadow-lg" data-bs-toggle="modal" data-bs-target="#newBabyModal">
                <i class="fas fa-plus-circle me-2"></i>Cadastrar Novo Bebê
            </button>
            <button class="btn btn-success btn-lg shadow-lg" data-bs-toggle="modal" data-bs-target="#babyListModal">
                <i class="fas fa-list me-2"></i>Bebês Cadastrados
            </button>
        </div>

        <!-- Nome do bebê selecionado -->
        <div class="dropdown mb-4">
            <h2 id="selectedBabyName" class="dropdown-toggle text-center p-3 bg-primary text-white rounded shadow-lg" data-bs-toggle="dropdown" aria-expanded="false" style="cursor: pointer; position: relative; padding-right: 1.5em;">
                Selecione um bebê
                <span style="position: absolute; right: 15px; top: 50%; transform: translateY(-50%);">&#9662;</span>
            </h2>
            <ul class="dropdown-menu w-100" id="babyDropdown" aria-labelledby="selectedBabyName">
                <!-- Os itens do dropdown serão inseridos aqui dinamicamente -->
            </ul>
        </div>

        <!-- Seletor de bebê (oculto visualmente) -->
        <div class="mb-3 d-none">
            <label for="babySelect" class="form-label">Selecione o Bebê</label>
            <select class="form-select" id="babySelect">
                <option value="">Escolha um bebê</option>
            </select>
        </div>

        <!-- Calendário -->
        <div class="mb-4">
            <label for="dateSelect" class="form-label">Selecione a Data</label>
            <input type="text" class="form-control" id="dateSelect">
        </div>

        <!-- Cronômetro -->
        <div id="timerContainer" class="mb-4 text-center">
            <div id="timer" class="display-1 mb-3">00:00:00</div>
            <div class="btn-group" role="group" aria-label="Timer controls">
                <button id="startTimer" class="btn btn-success btn-lg"><i class="fas fa-play"></i></button>
                <button id="pauseTimer" class="btn btn-warning btn-lg" disabled><i class="fas fa-pause"></i></button>
                <button id="stopTimer" class="btn btn-danger btn-lg" disabled><i class="fas fa-stop"></i></button>
            </div>
        </div>

        <!-- Formulário de registro de mamada -->
        <form id="feedingForm">
            <div class="mb-3 mt-4">
                <label for="startTime" class="form-label">Hora Inicial</label>
                <input type="time" class="form-control" id="startTime" required>
            </div>
            <div class="mb-3">
                <label for="endTime" class="form-label">Hora Final</label>
                <input type="time" class="form-control" id="endTime" required>
            </div>
            <div class="mb-3">
                <label for="formulaAmount" class="form-label">Quantidade de Fórmula (ml)</label>
                <input type="number" class="form-control" id="formulaAmount" min="0" step="1">
            </div>
            <button type="submit" class="btn btn-primary btn-lg w-100 mt-4 shadow-lg register-feeding-btn">
                <i class="fas fa-baby-carriage me-2"></i>Registrar Mamada
            </button>
        </form>
        <div id="feedingList" class="mt-4"></div>
        <div id="totalFormula" class="alert alert-success mt-3"></div>
    </div>

    <!-- Modal para cadastro de novo bebê -->
    <div class="modal fade" id="newBabyModal" tabindex="-1" aria-labelledby="newBabyModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="newBabyModalLabel">Adicionar Novo Bebê</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Fechar"></button>
                </div>
                <div class="modal-body">
                    <form id="newBabyForm">
                        <div class="mb-3">
                            <label for="babyName" class="form-label">Nome do Bebê</label>
                            <input type="text" class="form-control" id="babyName" required>
                        </div>
                        <div class="mb-3">
                            <label for="birthDate" class="form-label">Data de Nascimento</label>
                            <input type="date" class="form-control" id="birthDate" required>
                        </div>
                        <div class="mb-3">
                            <label for="motherName" class="form-label">Nome da Mãe</label>
                            <input type="text" class="form-control" id="motherName" required>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
                    <button type="button" class="btn btn-primary" id="saveBabyBtn">Salvar</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal para listar bebês cadastrados -->
    <div class="modal fade" id="babyListModal" tabindex="-1" aria-labelledby="babyListModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="babyListModalLabel">Bebês Cadastrados</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Fechar"></button>
                </div>
                <div class="modal-body">
                    <ul id="babyList" class="list-group">
                        <!-- A lista de bebês será inserida aqui dinamicamente -->
                    </ul>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Fechar</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal para editar bebê -->
    <div class="modal fade" id="editBabyModal" tabindex="-1" aria-labelledby="editBabyModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="editBabyModalLabel">Editar Bebê</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Fechar"></button>
                </div>
                <div class="modal-body">
                    <form id="editBabyForm">
                        <input type="hidden" id="editBabyIndex">
                        <div class="mb-3">
                            <label for="editBabyName" class="form-label">Nome do Bebê</label>
                            <input type="text" class="form-control" id="editBabyName" required>
                        </div>
                        <div class="mb-3">
                            <label for="editBirthDate" class="form-label">Data de Nascimento</label>
                            <input type="date" class="form-control" id="editBirthDate" required>
                        </div>
                        <div class="mb-3">
                            <label for="editMotherName" class="form-label">Nome da Mãe</label>
                            <input type="text" class="form-control" id="editMotherName" required>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
                    <button type="button" class="btn btn-primary" id="saveEditBabyBtn">Salvar</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal de confirmação de edição de bebê -->
    <div class="modal fade" id="editBabyConfirmationModal" tabindex="-1" aria-labelledby="editBabyConfirmationModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered modal-sm">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="editBabyConfirmationModalLabel">Bebê Atualizado</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Fechar"></button>
                </div>
                <div class="modal-body text-center">
                    <i class="fas fa-check-circle fa-3x text-success mb-3"></i>
                    <p>As informações do bebê foram atualizadas com sucesso!</p>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-primary" id="editConfirmationOkBtn">OK</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal de confirmação de cadastro de bebê -->
    <div class="modal fade" id="babyConfirmationModal" tabindex="-1" aria-labelledby="babyConfirmationModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered modal-sm">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="babyConfirmationModalLabel">Bebê Cadastrado</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Fechar"></button>
                </div>
                <div class="modal-body text-center">
                    <i class="fas fa-baby fa-3x text-success mb-3"></i>
                    <p>O bebê foi cadastrado com sucesso!</p>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-primary" data-bs-dismiss="modal">OK</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal de confirmação de exclusão de bebê -->
    <div class="modal fade" id="deleteBabyConfirmationModal" tabindex="-1" aria-labelledby="deleteBabyConfirmationModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="deleteBabyConfirmationModalLabel">Confirmar Exclusão</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Fechar"></button>
                </div>
                <div class="modal-body text-center">
                    <i class="fas fa-exclamation-triangle fa-3x text-warning mb-3"></i>
                    <p>Tem certeza que deseja excluir o bebê <strong id="babyNameToDelete"></strong>?</p>
                    <p class="text-danger">Esta ação não pode ser desfeita.</p>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" id="cancelDeleteBtn" data-bs-dismiss="modal">Cancelar</button>
                    <button type="button" class="btn btn-danger" id="confirmDeleteBabyBtn">Excluir</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal de confirmação de exclusão bem-sucedida -->
    <div class="modal fade" id="deleteBabySuccessModal" tabindex="-1" aria-labelledby="deleteBabySuccessModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered modal-sm">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="deleteBabySuccessModalLabel">Bebê Excluído</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Fechar"></button>
                </div>
                <div class="modal-body text-center">
                    <i class="fas fa-check-circle fa-3x text-success mb-3"></i>
                    <p>O bebê foi excluído com sucesso.</p>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-primary" data-bs-dismiss="modal">OK</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
    <script type="module">
        import { auth, db } from './firebase-config.js';
        import { onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/9.22.1/firebase-auth.js";
        import { doc, getDoc, updateDoc, arrayUnion, arrayRemove } from "https://www.gstatic.com/firebasejs/9.22.1/firebase-firestore.js";

        document.addEventListener('DOMContentLoaded', () => {
            onAuthStateChanged(auth, async (user) => {
                if (user) {
                    try {
                        const userDoc = await getDoc(doc(db, "users", user.uid));
                        const currentUser = userDoc.data();
                        
                        const userGreeting = document.getElementById('userGreeting');
                        userGreeting.innerHTML = `<h3>Olá, ${currentUser.name} 👋</h3>`;

                        const feedingForm = document.getElementById('feedingForm');
                        const feedingList = document.getElementById('feedingList');
                        const babySelect = document.getElementById('babySelect');
                        const selectedBabyName = document.getElementById('selectedBabyName');
                        const babyDropdown = document.getElementById('babyDropdown');

                        function updateBabyDropdown() {
                            babyDropdown.innerHTML = '';
                            if (currentUser.babies && currentUser.babies.length > 0) {
                                currentUser.babies.forEach((baby, index) => {
                                    const li = document.createElement('li');
                                    const a = document.createElement('a');
                                    a.className = 'dropdown-item';
                                    a.href = '#';
                                    a.textContent = baby.name;
                                    a.dataset.index = index;
                                    li.appendChild(a);
                                    babyDropdown.appendChild(li);
                                });
                                
                                // Selecionar o bebê salvo no perfil do usuário
                                const selectedIndex = currentUser.selectedBabyIndex || 0;
                                selectedBabyName.textContent = currentUser.babies[selectedIndex].name;
                            } else {
                                selectedBabyName.textContent = 'Nenhum bebê cadastrado';
                            }
                        }

                        updateBabyDropdown();

                        babyDropdown.addEventListener('click', async (e) => {
                            if (e.target.classList.contains('dropdown-item')) {
                                e.preventDefault();
                                const selectedIndex = parseInt(e.target.dataset.index);
                                if (!isNaN(selectedIndex)) {
                                    selectedBabyName.textContent = currentUser.babies[selectedIndex].name;
                                    
                                    // Atualizar o índice do bebê selecionado no Firestore
                                    await updateDoc(doc(db, "users", user.uid), {
                                        selectedBabyIndex: selectedIndex
                                    });

                                    // Atualizar a exibição das mamadas (se necessário)
                                    displayFeedings(selectedIndex);
                                }
                            }
                        });

                        function updateBabySelect() {
                            babySelect.innerHTML = '<option value="">Escolha um bebê</option>';
                            if (currentUser.babies && currentUser.babies.length > 0) {
                                currentUser.babies.forEach((baby, index) => {
                                    const option = document.createElement('option');
                                    option.value = index;
                                    option.textContent = baby.name;
                                    babySelect.appendChild(option);
                                });
                                
                                // Selecionar o bebê salvo no perfil do usuário
                                const selectedIndex = currentUser.selectedBabyIndex || 0;
                                babySelect.value = selectedIndex.toString();
                                displayFeedings(selectedIndex);
                                selectedBabyName.textContent = currentUser.babies[selectedIndex].name;
                            } else {
                                feedingList.innerHTML = '<p>Nenhum bebê cadastrado. Por favor, adicione um bebê.</p>';
                                selectedBabyName.textContent = 'Nenhum bebê selecionado';
                            }
                        }

                        updateBabySelect();

                        // Função para exibir as mamadas do bebê selecionado
                        function displayFeedings(babyIndex) {
                            // Implemente a lógica para exibir as mamadas aqui
                            console.log(`Exibindo mamadas para o bebê de índice ${babyIndex}`);
                        }

                        babySelect.addEventListener('change', async (e) => {
                            const selectedIndex = parseInt(e.target.value);
                            if (!isNaN(selectedIndex)) {
                                displayFeedings(selectedIndex);
                                selectedBabyName.textContent = currentUser.babies[selectedIndex].name;
                                
                                // Atualizar o índice do bebê selecionado no Firestore
                                await updateDoc(doc(db, "users", user.uid), {
                                    selectedBabyIndex: selectedIndex
                                });
                            } else {
                                feedingList.innerHTML = '';
                                selectedBabyName.textContent = 'Nenhum bebê selecionado';
                            }
                        });

                        const newBabyForm = document.getElementById('newBabyForm');
                        const saveBabyBtn = document.getElementById('saveBabyBtn');
                        const newBabyModal = new bootstrap.Modal(document.getElementById('newBabyModal'));
                        const babyConfirmationModal = new bootstrap.Modal(document.getElementById('babyConfirmationModal'));

                        saveBabyBtn.addEventListener('click', async () => {
                            const babyName = document.getElementById('babyName').value;
                            const birthDate = document.getElementById('birthDate').value;
                            const motherName = document.getElementById('motherName').value;

                            if (babyName && birthDate && motherName) {
                                const newBaby = {
                                    name: babyName,
                                    birthDate: birthDate,
                                    motherName: motherName,
                                    feedings: {}
                                };

                                try {
                                    // Adicionar o novo bebê ao array de bebês do usuário no Firestore
                                    await updateDoc(doc(db, "users", user.uid), {
                                        babies: arrayUnion(newBaby)
                                    });

                                    // Atualizar a lista de bebês na interface
                                    currentUser.babies.push(newBaby);
                                    updateBabySelect();
                                    updateBabyList(); // Atualizar a lista no modal
                                    updateBabyDropdown(); // Atualizar o dropdown

                                    // Fechar o modal de cadastro e limpar o formulário
                                    newBabyModal.hide();
                                    newBabyForm.reset();

                                    // Exibir o modal de confirmação
                                    babyConfirmationModal.show();
                                } catch (error) {
                                    console.error("Erro ao adicionar bebê:", error);
                                    alert('Erro ao adicionar bebê. Por favor, tente novamente.');
                                }
                            } else {
                                alert('Por favor, preencha todos os campos.');
                            }
                        });

                        const babyListModal = new bootstrap.Modal(document.getElementById('babyListModal'));
                        const editBabyModal = new bootstrap.Modal(document.getElementById('editBabyModal'));
                        const editBabyConfirmationModal = new bootstrap.Modal(document.getElementById('editBabyConfirmationModal'));
                        const deleteBabyConfirmationModal = new bootstrap.Modal(document.getElementById('deleteBabyConfirmationModal'));
                        const deleteBabySuccessModal = new bootstrap.Modal(document.getElementById('deleteBabySuccessModal'));
                        const babyListElement = document.getElementById('babyList');
                        const editBabyForm = document.getElementById('editBabyForm');
                        const saveEditBabyBtn = document.getElementById('saveEditBabyBtn');
                        const editConfirmationOkBtn = document.getElementById('editConfirmationOkBtn');
                        const confirmDeleteBabyBtn = document.getElementById('confirmDeleteBabyBtn');
                        const babyNameToDeleteElement = document.getElementById('babyNameToDelete');

                        let babyToDeleteIndex = -1;

                        // Função para atualizar a lista de bebês no modal
                        function updateBabyList() {
                            babyListElement.innerHTML = '';
                            if (currentUser.babies && currentUser.babies.length > 0) {
                                currentUser.babies.forEach((baby, index) => {
                                    const li = document.createElement('li');
                                    li.className = 'list-group-item d-flex justify-content-between align-items-center';
                                    li.innerHTML = `
                                        <span>${baby.name}</span>
                                        <div>
                                            <button class="btn btn-sm btn-primary edit-baby" data-index="${index}">Editar</button>
                                            <button class="btn btn-sm btn-danger delete-baby" data-index="${index}">Excluir</button>
                                        </div>
                                    `;
                                    babyListElement.appendChild(li);
                                });
                            } else {
                                babyListElement.innerHTML = '<li class="list-group-item">Nenhum bebê cadastrado.</li>';
                            }
                        }

                        // Atualizar a lista de bebês quando o modal for aberto
                        document.getElementById('babyListModal').addEventListener('show.bs.modal', updateBabyList);

                        babyListElement.addEventListener('click', (e) => {
                            if (e.target.classList.contains('edit-baby')) {
                                const index = e.target.dataset.index;
                                const baby = currentUser.babies[index];
                                document.getElementById('editBabyIndex').value = index;
                                document.getElementById('editBabyName').value = baby.name;
                                document.getElementById('editBirthDate').value = baby.birthDate;
                                document.getElementById('editMotherName').value = baby.motherName;
                                babyListModal.hide();
                                editBabyModal.show();
                            } else if (e.target.classList.contains('delete-baby')) {
                                babyToDeleteIndex = e.target.dataset.index;
                                const babyName = currentUser.babies[babyToDeleteIndex].name;
                                babyNameToDeleteElement.textContent = babyName;
                                babyListModal.hide();
                                deleteBabyConfirmationModal.show();
                            }
                        });

                        confirmDeleteBabyBtn.addEventListener('click', async () => {
                            if (babyToDeleteIndex !== -1) {
                                currentUser.babies.splice(babyToDeleteIndex, 1);
                                try {
                                    await updateDoc(doc(db, "users", user.uid), {
                                        babies: currentUser.babies
                                    });
                                    updateBabyList();
                                    updateBabySelect();
                                    updateBabyDropdown();
                                    deleteBabyConfirmationModal.hide();
                                    deleteBabySuccessModal.show();
                                } catch (error) {
                                    console.error("Erro ao excluir bebê:", error);
                                    alert('Erro ao excluir bebê. Por favor, tente novamente.');
                                }
                            }
                        });

                        // Evento para quando o modal de confirmação de exclusão for fechado
                        document.getElementById('deleteBabyConfirmationModal').addEventListener('hidden.bs.modal', (e) => {
                            if (!document.getElementById('deleteBabySuccessModal').classList.contains('show')) {
                                babyListModal.show();
                            }
                        });

                        // Evento para quando o modal de sucesso de exclusão for fechado
                        document.getElementById('deleteBabySuccessModal').addEventListener('hidden.bs.modal', () => {
                            babyListModal.show();
                        });

                        // Adicionar botão de cancelar no modal de confirmação de exclusão
                        const cancelDeleteBtn = document.getElementById('cancelDeleteBtn');
                        if (cancelDeleteBtn) {
                            cancelDeleteBtn.addEventListener('click', () => {
                                deleteBabyConfirmationModal.hide();
                            });
                        }

                        // Salvar edições do bebê
                        saveEditBabyBtn.addEventListener('click', async () => {
                            const index = document.getElementById('editBabyIndex').value;
                            const editedBaby = {
                                name: document.getElementById('editBabyName').value,
                                birthDate: document.getElementById('editBirthDate').value,
                                motherName: document.getElementById('editMotherName').value,
                                feedings: currentUser.babies[index].feedings
                            };

                            currentUser.babies[index] = editedBaby;

                            try {
                                await updateDoc(doc(db, "users", user.uid), {
                                    babies: currentUser.babies
                                });
                                updateBabyList();
                                updateBabySelect();
                                updateBabyDropdown();
                                editBabyModal.hide();
                                editBabyConfirmationModal.show();
                            } catch (error) {
                                console.error("Erro ao atualizar bebê:", error);
                                alert('Erro ao atualizar informações do bebê. Por favor, tente novamente.');
                            }
                        });

                        // Botão OK no modal de confirmação de edição
                        editConfirmationOkBtn.addEventListener('click', () => {
                            editBabyConfirmationModal.hide();
                            babyListModal.show();
                        });

                        // Adicionar funcionalidade de logout
                        const logoutLink = document.getElementById('logoutLink');
                        const logoutLinkMobile = document.getElementById('logoutLinkMobile');

                        function logout(e) {
                            e.preventDefault();
                            signOut(auth).then(() => {
                                console.log('Usuário deslogado com sucesso');
                                window.location.href = 'login.html';
                            }).catch((error) => {
                                console.error("Erro ao fazer logout:", error);
                            });
                        }

                        // Adicionar funcionalidade de logout para ambos os links
                        if (logoutLink) {
                            logoutLink.addEventListener('click', logout);
                        }
                        if (logoutLinkMobile) {
                            logoutLinkMobile.addEventListener('click', logout);
                        }

                        // ... (resto do código existente) ...

                    } catch (error) {
                        console.error("Erro ao carregar dados do usuário:", error);
                    }
                } else {
                    window.location.href = 'login.html';
                }
            });
        });
    </script>
    <script src="app.js"></script>
    <script>
        // Código para fechar o menu ao clicar em um item
        document.querySelectorAll('.navbar-nav>li>a').forEach(link => {
            link.addEventListener('click', () => {
                const navbarCollapse = document.querySelector('.navbar-collapse');
                if (navbarCollapse.classList.contains('show')) {
                    navbarCollapse.classList.remove('show');
                }
            });
        });

        document.addEventListener('DOMContentLoaded', () => {
            // ... código existente ...

            function adjustBodyPadding() {
                const navbar = document.querySelector('.navbar');
                const navbarHeight = navbar.offsetHeight;
                document.body.style.paddingTop = (navbarHeight + 5) + 'px'; // Adicionando 5px de espaço extra
            }

            // Ajusta o padding inicialmente e sempre que a janela for redimensionada
            adjustBodyPadding();
            window.addEventListener('resize', adjustBodyPadding);
        });

        document.addEventListener('DOMContentLoaded', function() {
            function adjustNavItemsPadding() {
                const mamadasLink = document.getElementById('mamadasLink');
                const logoutLinkMobile = document.getElementById('logoutLinkMobile');
                
                if (window.innerWidth <= 991.98) {
                    mamadasLink.style.paddingTop = '0.5rem';
                    mamadasLink.style.marginTop = '1rem';
                    
                    logoutLinkMobile.style.paddingTop = '1.5rem';
                    logoutLinkMobile.style.marginTop = '1rem';
                } else {
                    mamadasLink.style.paddingTop = '';
                    mamadasLink.style.marginTop = '';
                    
                    logoutLinkMobile.style.paddingBottom = '0.5rem';
                    logoutLinkMobile.style.marginBottom = '1rem';
                }
            }

            // Ajusta o padding inicialmente
            adjustNavItemsPadding();

            // Ajusta o padding sempre que a janela for redimensionada
            window.addEventListener('resize', adjustNavItemsPadding);
        });
    </script>
</body>

</html>